(()=>{"use strict";class t{constructor(t,s,e,h=0,i=0){this.y=s,this.x=t,this.img=new Image,this.img.src=e,this.shiftX=h,this.shiftY=i}get width(){return this.img.width}get height(){return this.img.height}move(){this.x=this.x+this.shiftX,this.y=this.y+this.shiftY}draw(t){t.drawImage(this.img,this.x,this.y)}stopMoving(){this.shiftX=0,this.shiftY=0}}class s extends t{constructor(t,s,e){super(t,s,"./images/balle24.png",4,0),this.theGame=e}move(){const t=this.theGame.paddleLeft,s=this.theGame.paddleRight;this.y<=0||this.y+this.height>=this.theGame.canvas.height?this.shiftY=-this.shiftY:this.shiftX<0&&this.x>=t.x&&this.x<=t.x+t.width&&this.y>=t.y-this.height&&this.y<=t.y+t.height?(this.shiftX=Math.abs(this.shiftX)+1,document.getElementById("speed").innerText=`Speed = ${Math.abs(this.shiftX)}`,this.shiftY=this.getAngle(Math.floor((this.y+(this.y+this.height))/2),Math.floor((t.y+(t.y+t.height))/2),t.height)):this.shiftX>0&&this.x+this.width>=s.x&&this.x+this.width<=s.x+s.width&&this.y>=s.y-this.height&&this.y<=s.y+s.height?(this.shiftX=-Math.abs(this.shiftX)-1,document.getElementById("speed").innerText=`Speed = ${Math.abs(this.shiftX)}`,this.shiftY=this.getAngle(Math.floor((this.y+(this.y+this.height))/2),Math.floor((s.y+(s.y+s.height))/2),s.height)):this.x<=0?0!=this.shiftX&&(this.stopMoving(),s.addPoint(),this.theGame.displayScores(),this.theGame.status="Rematch",document.getElementById("playButton").value=this.theGame.status):this.x+this.width>=this.theGame.canvas.width&&0!=this.shiftX&&(this.stopMoving(),t.addPoint(),this.theGame.displayScores(),this.theGame.status="Rematch",document.getElementById("playButton").value=this.theGame.status),super.move()}getAngle(t,s,e){const h=e/8,i=t-s;let a=0;return i<0?a=Math.floor(i/h):i>0&&(a=Math.floor(i/h)+1),a}}class e extends t{score;constructor(t,s,e,h){super(t,s,e,0,50),this.theGame=h,this.score=0}moveUp(){this.y<=0?this.shiftY=-this.shiftY:(this.shiftY>0&&(this.shiftY=-this.shiftY),super.move())}moveDown(){this.y+this.height>=this.theGame.canvas.height?this.shiftY=-this.shiftY:(this.shiftY<0&&(this.shiftY=-this.shiftY),super.move())}addPoint(){this.score++}resetScore(){this.score=0}}io().on("newPlayer",(t=>{console.log(`${t} joined the game !`)}));class h{status;constructor(t){this.raf=null,this.canvas=t,this.ball=new s(this.canvas.width/2,this.canvas.height/2,this),this.paddleLeft=new e(10,this.canvas.height/2,"./images/paddle_left.png",this),this.paddleRight=new e(this.canvas.width-37,this.canvas.height/2,"./images/paddle_right.png",this),this.status="Stop",this.initPaddle()}start(){this.status="Start",document.getElementById("playButton").value="Stop",document.getElementById("speed").innerText=`Speed = ${Math.abs(this.ball.shiftX)}`,this.animate()}stop(){this.status="Stop",document.getElementById("playButton").value="Continue",window.cancelAnimationFrame(this.raf)}rematch(){this.status="Start",document.getElementById("playButton").value="Stop",this.raf=null,this.ball=new s(this.canvas.width/2,this.canvas.height/2,this),document.getElementById("speed").innerText=`Speed = ${Math.abs(this.ball.shiftX)}`}displayScores(){document.querySelector("#player1Score").innerText=this.paddleLeft.score,document.querySelector("#player2Score").innerText=this.paddleRight.score}initPaddle(){document.addEventListener("keydown",(t=>{t.preventDefault(),"Stop"!=this.status&&("ArrowUp"==t.key?(this.paddleRight.moveUp(),this.moveAndDraw()):"ArrowDown"==t.key?(this.paddleRight.moveDown(),this.moveAndDraw()):"z"==t.key?(this.paddleLeft.moveUp(),this.moveAndDraw()):"s"==t.key&&(this.paddleLeft.moveDown(),this.moveAndDraw()))}))}animate(){this.moveAndDraw(),this.raf=window.requestAnimationFrame(this.animate.bind(this))}moveAndDraw(){const t=this.canvas.getContext("2d");t.clearRect(0,0,this.canvas.width,this.canvas.height),this.ball.move(),this.ball.draw(t),this.paddleLeft.draw(t),this.paddleRight.draw(t)}}const i=document.getElementById("field");window.addEventListener("load",(()=>{const t=document.getElementById("playButton"),s=new h(i);t.addEventListener("click",(t=>{t.preventDefault(),"Stop"==s.status?s.start():"Start"==s.status?s.stop():"Rematch"==s.status&&s.rematch()}))}))})();